syntax = 'proto3';

import "franka_controller.proto";

package bamboo;

// gRPC service for Bamboo arm control
// Replaces the ZMQ pub-sub pattern for arm control only
// Gripper communication remains ZMQ-based
service BambooControlService {
  // Get current robot state (replaces ZMQ state subscriber on port+1)
  rpc GetRobotState(RobotStateRequest) returns (FrankaRobotStateMessage);

  // Execute a sequence of joint impedance control waypoints
  // Sends all waypoints as a single request, waits for entire trajectory to complete
  rpc ExecuteJointImpedanceTrajectory(JointImpedanceTrajectoryRequest) returns (FrankaCommandResponse);

  // Terminate the control node gracefully
  rpc Terminate(TerminateRequest) returns (FrankaCommandResponse);
}

// Request message for getting robot state
message RobotStateRequest {
  // Empty for now, can add filtering options later if needed
}

// Waypoint with timing information
message TimedWaypoint {
  // The control message for this waypoint
  FrankaControlMessage waypoint = 1;

  // Duration for this waypoint in seconds (default: 0.5s if not specified)
  double duration = 2;
}

// Request message for joint impedance trajectory with multiple waypoints
message JointImpedanceTrajectoryRequest {
  // Sequence of timed waypoints to execute
  repeated TimedWaypoint waypoints = 1;

  // Default duration for waypoints that don't specify their own (default: 0.5s)
  double default_duration = 2;
}

// Request to terminate the control node
message TerminateRequest {
  // Empty for now
}
